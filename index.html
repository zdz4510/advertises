<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="style/style.css"/>
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <style>
        #textas{
            width: 200px;
            height: 50px;
        }
    </style>
</head>
<body>
    <div class="head">
        <div class="h_c">
            <div class="hl">
                <p>北京 <span>[切换城市]</span></p>
            </div>
            <div class="hr">
                <p><a id="enter" href="javascript:void(0)">登录</a> / <a id="login" href="javascript:void(0)">注册</a></p>
                <p><a id="personal" href="javascript:void(0)">个人中心 <img src="images/index/u113.png" /></a></p>
                <p><a href="#">商家中心 <img src="images/index/u113.png" /></a></p>
            </div>
        </div>
    </div>
    <div id="nry">
        <div class="h_se">
        <div class="s_logo">
            <img id="u135_img" class="img " src="images/index/u135.png">
        </div>
        <div class="s_search">
            <input type="text" id="ss" />
            <input type="button" id="sb" value="搜职位" />
            <!-- <img  id="si" src="images/index/u138.png" /> -->
            <ul>
                <!-- <li><a href="#">收营员</a></li>
                <li><a href="#">收营员</a></li>
                <li><a href="#">收营员</a></li>
                <li><a href="#">收营员</a></li>
                <li><a href="#">收营员</a></li> -->
            </ul>
        </div>
    </div>
    <div class="hm">
        <div class="hm_1">
            <div class="hm_1_l">职位：</div>
            <div class="hm_1_r">
                <ul id="d_job">
                    <li><a href="#"   class="s">全部</a></li>
                    <!-- <li><a href="#" >超市/零售</a>
           
                    </li>
                    <li><a href="#">影视/娱乐</a></li>
                    <li><a href="#">教育培训</a></li>
                    <li><a href="#">餐饮</a></li>
                    <li><a href="#">客服</a></li>
                    <li><a href="#">销售</a></li>
                    <li><a href="#">仓储/物流</a></li>
                    <li><a href="#">实习生</a></li>
                    <li><a href="#">家政/安保</a></li>
                    <li><a href="#">翻译</a></li>
                    <li><a href="#">美容美</a></li> -->
                </ul>
            </div>
            <div class="c"></div>
        </div>
        <div class="hm_1">
            <div class="hm_1_l">地点：</div>
            <div class="hm_1_r">
                <ul id="d_loc">
                    <li><a href="#"   class="s">全部</a></li>
                    <!-- <li><a href="#">海淀</a></li>
                    <li><a href="#">海淀</a></li>
                    <li><a href="#">海淀</a></li>
                    <li><a href="#">海淀</a></li>
                    <li><a href="#">海淀</a></li> -->
                </ul>
            </div>
            <div class="c"></div>
        </div>
        <div class="hm_1">
            <div class="hm_1_l">福利：</div>
            <div class="hm_1_r">
                <ul id="d_wel">
                    <li><a href="#"   class="s">全部</a></li>
                </ul>
            </div>
            <div class="c"></div>
        </div>
        <div class="hm_1 b">
            <div class="hm_1_l">已选：</div>
            <div class="hm_1_r">
               <!--  <div class="yx">超市/零售 - 收营员 <img id="u192_img" class="img " src="images/index/u192.png"></div> -->
            </div>
            <div class="c"></div>
        </div>
    </div>

    <div id="con_menu">
      <!--   <div class="m">
            <h4>190/天上一休一连锁超市急招营业员</h4>
            <div class="m_1">4000-5000 元/月</div>
            <div class="w">
            <div class="m_2 c1">五险一金</div>
            <div class="m_2 c2">包吃</div>
            <div class="m_2 c3">包住</div>
            </div>
            <div class="m_9">
                <p>工作时间：全职工作</p>
                <p>工作类型：收银员</p>
                <p>招聘人数：10人</p>
                <p>工作地点：海淀知春路</p>
            </div>
            <div class="m_3">一键报名</div>
            
        </div>  -->
    </div>

    <div class="ym">
        <ul>
            <li>&lt;</li>
            <li>1</li>
            <li>2</li>
            <li>...</li>
            <li>10</li>
            <li>&gt;</li>
        </ul>
    </div>

    <div class="f" style=" border:1px solid #999;">
        
        ©2015-2019 ####################有限公司 ##ICP备#############号 ##公网安备###############号 联系电话：####-###########
    </div>
    </div>
    
    <!-- 一键报名 -->
<div class="modal fade" id="mymodal">
  <div class="modal-dialog  modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">报名详情</h4>
      </div>
      <div class="modal-body">
            <form class="form-inline">
              <div class="form-group">
                <label for="exampleInputName1" style="width:80px">用户名</label>
                <input type="text" name='username' class="form-control" id="exampleInputName1"  style="width:200px">
                <label for="exampleInputName2"  style="width:80px">真实姓名</label>
                <input type="text" name='realname' class="form-control" id="exampleInputName2"  style="width:200px">
              </div>
              <div class="form-group">
                <label for="exampleInputName4"  style="width:80px">学历</label>
                <input type="text" name='' class="form-control" id="exampleInputName4"  style="width:200px">
              </div>
              <div class="form-group">
                <label for="exampleInputName5" style="width:80px">性别</label>
                <div class="form-check form-check-inline">
                    <input id="input_gender_male" type="radio" class="form-check-input" name="gender" value="male"  style="width:20px">
                    <label for="input_gender_male" class="form-check-label"  style="width:40px">男</label>
                </div>
                <div class="form-check form-check-inline">
                    <input id="input_gender_female" type="radio" class="form-check-input" name="gender" value="female"  style="width:20px">
                <label for="input_gender_female" class="form-check-label"  style="width:40px">女</label> 
                </div>
              </div>
              <div class="form-group">
               <label id="tel" for="exampleInputName6"  style="width:80px">联系方式</label>
                <input type="text" name='telephone' class="form-control" id="exampleInputName6" style="width:200px">
              </div>
            </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" id="yj_save">保存</button>
      </div>
    </div>
  </div>
</div>
<!-- /一键报名 -->
    <script>
        $(function(){
            var baseUrl="http://203.195.246.58:7777";
            // alert(1);
            function reload(){
                $("#con_menu").empty();
                // console.log(1);
                $.get(baseUrl+"/Employment/findAll",function(result){
                result.data.forEach(function(item,index){
                    // console.log(item.province);
                    // 将数据加载到文本框中
                    var newD=$(`
                        <div id="m" class="m">
                            <h4>`+item.title+`</h4>
                            <div class="m_1">`+item.salary+` 元/月</div>
                            <div class="w">
                            <div class="m_2 c1">`+item.welfare+`</div>
                            </div>
                            <div class="m_9">
                                <p>工作时间：`+item.workingHours+`</p>
                                <p>工作类型：`+item.job+`</p>
                                <p>招聘人数：`+item.num+`</p>
                                <p>工作地点：`+item.city+`</p>
                            </div>
                            <div id="yj" class="m_3">一键报名</div>
                        </div> 
                        `);
                    $("#con_menu").append(newD);
                })
                    // 将职位渲染到页面
                    // 遍历数据中的要筛选的数据,并删除要塞选的重复数据显示到选项卡中
                    var a=[],b=[],c=[];
                    result.data.forEach(function(item,index){
                        
                        a.push(item.job);
                        b.push(item.city);
                        c.push(item.welfare);
                    })
                    var newa=[],newb=[],newc=[];
                    //2.遍历旧数组a 中所有元素;
                    for(var i=0;i<=a.length;i++){
                      //3.定义一个isZai变量表示开关，默认为false状态;
                      var isZai=false;
                      for(var j=0;j<=newa.length;j++){
                      // 4.遍历新数组所有元素与旧数组元素比较(a[ i ] == newa[ j ]);
                            if(a[ i ] == newa[ j ]){
                            //5.如果该元素存在于新数组中，则改变开关状态为true;
                            isZai=true;//假设被推翻
                            break;//一旦重复后面没有比较必要
                        }
                      }
                      // 6.根据开关状态实现需求:如果开关为false状态，则将旧数组的元素添加到新数组中;
                      if(isZai==false){
                            newa[newa.length]=a[i];
                        }
                    }
                     for(var i=0;i<newa.length;i++){
                        // console.log(i)
                        //追加职位栏中
                         var jobs=$(`
                            <li><a href="javascript:void(0)">`+newa[i]+`</a></li>
                            `);
                         $("#d_job").append(jobs);
                     }


                    //复制一份
                     for(var i=0;i<=b.length;i++){
                      var isZa=false;
                      for(var j=0;j<=newb.length;j++){
                            if(b[ i ] == newb[ j ]){
                            isZa=true;
                            break;
                        }
                      }
                      if(isZa==false){
                            newb[newb.length]=b[i];
                        }
                    }
                     for(var i=0;i<newb.length;i++){
                        // console.log(newb[i]);
                         var loc=$(`
                            <li><a href="javascript:void(0)">`+newb[i]+`</a></li>
                            `);
                         $("#d_loc").append(loc);
                     }
                     //在复制一份
                     for(var i=0;i<=c.length;i++){
                      var isZ=false;
                      for(var j=0;j<=newc.length;j++){
                            if(c[ i ] == newc[ j ]){
                            isZ=true;
                            break;
                        }
                      }
                      if(isZ==false){
                            newc[newc.length]=c[i];
                        }
                    }
                     for(var i=0;i<newc.length;i++){
                        // console.log(newb[i]);
                         var wel=$(`
                            <li><a href="javascript:void(0)">`+newc[i]+`</a></li>
                            `);
                         $("#d_wel").append(wel);
                     }
            })  
            }
            reload();
            // 选择
            $("#d_job").on("click","a",function(event){
                // 给选中的添加背景，其他的移除背景
                $(this).addClass("s");
                $(this).parent().siblings().find("a").removeClass("s");
                console.log($(this)[0].innerText);
                var job=$(this)[0].innerText;
                
                var dat={job:job}
                $.get(baseUrl+"/Employment/findByJob",dat,function(result){
                    // console.log(233);
                    if(result.status==200){
                        // 清空
                        $("#con_menu").empty();
                        // 点击城市按钮时
                        $("#d_loc").on("click","a",function(event){
                            $(this).addClass("s");
                            $(this).parent().siblings().find("a").removeClass("s");
                            // 获取选中的城市
                            console.log($(this)[0].innerText);
                            var city=$(this)[0].innerText;
                            var data={
                                city:city
                            }
                            $.get(baseUrl+"/Employment/findByCity",data,function(result){
                                if(result.status==200){
                                    $("#con_menu").empty();
                                    $("#d_wel").on("click","a",function(event){
                                        $(this).addClass("s");
                                        $(this).parent().siblings().find("a").removeClass("s");
                                        // 获取选中的福利
                                        console.log($(this)[0].innerText);
                                        var welfare=$(this)[0].innerText;
                                        $.get(baseUrl+"/Employment/findAll",function(result){

                                            if(result.status==200){
                                                result.data.forEach(function(item,index){
                                                    console.log(welfare);
                                                    if(job==item.job&&city==item.city&&welfare==item.welfare){
                                                        var newD=$(`
                                                        <div id="m" class="m">
                                                            <h4>`+item.title+`</h4>
                                                            <div class="m_1">`+item.salary+` 元/月</div>
                                                            <div class="w">
                                                            <div class="m_2 c1">`+item.welfare+`</div>
                                                            </div>
                                                            <div class="m_9">
                                                                <p>工作时间：`+item.workingHours+`</p>
                                                                <p>工作类型：`+item.job+`</p>
                                                                <p>招聘人数：`+item.num+`</p>
                                                                <p>工作地点：`+item.city+`</p>
                                                            </div>
                                                            <div id="yj" class="m_3">一键报名</div>
                                                        </div> 
                                                        `);
                                                        $("#con_menu").append(newD);
                                                    }
                                                })
                                            }else{
                                                alert(result.message)
                                            }
                                        })
                                    }) 

                                }else{
                                    alert(result.message);
                                }
                            })
                        })
                    }else{
                        alert(result.message);} 
                })
            })
            // 搜索
            $("#sb").click(function(){
                // 获取输入值，查询
                // console.log($("#ss").val());
                var job=$("#ss").val()
                
                var data={job:job}
                $.get(baseUrl+"/Employment/findByJob",data,function(result){
                    // console.log(233);
                    if(result.status==200){
                        // 清空
                        $("#con_menu").empty();
                        result.data.forEach(function(item,index){
                        // console.log(item.province);
                        // 将数据加载到文本框中
                        var newD=$(`
                            <div id="m" class="m">
                                <h4>`+item.title+`</h4>
                                <div class="m_1">`+item.salary+` 元/月</div>
                                <div class="w">
                                <div class="m_2 c1">`+item.welfare+`</div>
                                </div>
                                <div class="m_9">
                                    <p>工作时间：`+item.workingHours+`</p>
                                    <p>工作类型：`+item.job+`</p>
                                    <p>招聘人数：`+item.num+`</p>
                                    <p>工作地点：`+item.city+`</p>
                                </div>
                                <div id="yj" class="m_3">一键报名</div>
                            </div> 
                            `);
                            $("#con_menu").append(newD);
                        })
                    }else{
                        alert(result.message);} 
                })
            })
            $("#con_menu").on("click","#yj",function(){
                $("#mymodal").modal("show");
                $("#yj_save").click(function(){
                    var username=$("#mymodal").find("input")[0].value;
                    var realname=$("#mymodal").find("input")[1].value;
                    var education=$("#mymodal").find("input")[2].value;
                    var telephone=$("#mymodal").find("input")[5].value;
                    var data={
                        username:username,
                        realname:realname,
                        education:education,
                        telephone:telephone
                    }
                    $.post(baseUrl+"/Jobhunter/saveOrUpdate",data,function(result){
                        if(result.status==200){
                            // console.log(data.telephone);
                            $("#mymodal").modal("hide");
                            alert("报名成功");
                        }else{
                            $("#mymodal").modal("hide");
                            alert("报名失败");
                            
                        }

                    })
                })
                
            })
            $("#enter").click(function(){
                $("#nry").load("./pages/enter.html");
            })
            $("#personal").click(function(){
                // alert(0);
                $("#nry").load("./pages/personal.html");
            })
            })
    </script>
</body>
</html>